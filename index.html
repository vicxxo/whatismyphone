<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>스마트폰 기종확인</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Arial,sans-serif;margin:0;padding:24px;line-height:1.45;background:#fafafa;}
    .card{max-width:720px;margin:0 auto;background:#fff;border:1px solid #ddd;border-radius:12px;padding:24px;}
    h1{margin:0 0 8px;}
    .muted{color:#666;font-size:14px;margin-bottom:16px;}
    .kv{display:grid;grid-template-columns:120px 1fr;gap:6px;font-size:15px;}
    .result{font-size:28px;font-weight:700;margin:20px 0;}
    button{font-size:16px;padding:10px 14px;border-radius:10px;border:1px solid #ccc;background:#fff;cursor:pointer;}
    button.primary{border-color:#222;}
    .badge{display:inline-block;padding:2px 8px;border:1px solid #bbb;border-radius:999px;font-size:12px;color:#444;margin-left:6px;}
  </style>
</head>
<body>
  <div class="card">
    <h1>기종확인</h1>
    <div class="muted">QR 촬영 후 자동으로 기종이 표시됩니다.</div>

    <div class="kv">
      <div>브랜드</div><div id="brand">-</div>
      <div>모델</div><div id="model">-</div>
      <div>OS</div><div id="os">-</div>
      <div>브라우저</div><div id="browser">-</div>
    </div>

    <div class="result" id="headline">확인 중...</div>

    <button class="primary" id="detectBtn">기종확인 다시 실행</button>
    <span class="badge" id="accuracyBadge">자동판별</span>
  </div>

  <script>
    // 삼성 최신 모델 매핑
    const samsungModels = {
      "SM-S938": "Galaxy S25 Ultra",
      "SM-S936": "Galaxy S25+",
      "SM-S931": "Galaxy S25",
      "SM-S928": "Galaxy S24 Ultra",
      "SM-S926": "Galaxy S24+",
      "SM-S921": "Galaxy S24",
      "SM-S918": "Galaxy S23 Ultra",
      "SM-S916": "Galaxy S23+",
      "SM-S911": "Galaxy S23",
      "SM-S908": "Galaxy S22 Ultra",
      "SM-S906": "Galaxy S22+",
      "SM-S901": "Galaxy S22",
      "SM-F951": "Galaxy Z Fold7",
      "SM-F751": "Galaxy Z Flip7",
      "SM-F946": "Galaxy Z Fold5",
      "SM-F741": "Galaxy Z Flip5",
      "SM-F936": "Galaxy Z Fold4",
      "SM-F731": "Galaxy Z Flip4",
      "SM-F926": "Galaxy Z Fold3",
      "SM-F711": "Galaxy Z Flip3"
    };

    // iPhone 전체 시리즈 (12~17)
    const iPhoneMap = {
      // iPhone 17 시리즈
      "iPhone18,2": "iPhone 17 Pro Max",
      "iPhone18,1": "iPhone 17 Pro",
      "iPhone18,3": "iPhone 17",
      "iPhone18,4": "iPhone 17 Air",
      // iPhone 16 시리즈
      "iPhone17,5": "iPhone 16e",
      "iPhone17,2": "iPhone 16 Pro Max",
      "iPhone17,1": "iPhone 16 Pro",
      "iPhone17,4": "iPhone 16 Plus",
      "iPhone17,3": "iPhone 16",
      // iPhone 15 시리즈
      "iPhone16,2": "iPhone 15 Plus",
      "iPhone16,1": "iPhone 15",
      "iPhone17,1": "iPhone 15 Pro",  // 일부 iOS 식별자 중복 케이스
      "iPhone17,2": "iPhone 15 Pro Max",
      // iPhone 14 시리즈
      "iPhone15,3": "iPhone 14 Pro Max",
      "iPhone15,2": "iPhone 14 Pro",
      "iPhone14,8": "iPhone 14 Plus",
      "iPhone14,7": "iPhone 14",
      // iPhone 13 시리즈
      "iPhone14,5": "iPhone 13",
      "iPhone14,2": "iPhone 13 Pro",
      "iPhone14,3": "iPhone 13 Pro Max",
      "iPhone14,4": "iPhone 13 mini",
      // iPhone 12 시리즈
      "iPhone13,2": "iPhone 12",
      "iPhone13,3": "iPhone 12 Pro",
      "iPhone13,4": "iPhone 12 Pro Max",
      "iPhone13,1": "iPhone 12 mini"
    };

    function getParam(name){return new URLSearchParams(location.search).get(name)||"";}

    async function detect(){
      const brandEl=document.getElementById('brand');
      const modelEl=document.getElementById('model');
      const osEl=document.getElementById('os');
      const browserEl=document.getElementById('browser');
      const headlineEl=document.getElementById('headline');
      const badge=document.getElementById('accuracyBadge');

      let ua=navigator.userAgent||"";
      let brand="",model="",os="",browser="";

      // 브라우저 추정
      if(/Edg\//.test(ua))browser="Edge";
      else if(/Chrome\//.test(ua))browser="Chrome";
      else if(/Firefox\//.test(ua))browser="Firefox";
      else if(/Safari\//.test(ua)&&!/Chrome\//.test(ua))browser="Safari";
      else browser="기타";

      const isAndroid=/Android/i.test(ua);
      const isIOS=/iPhone|iPad|iPod/i.test(ua);

      // UA-CH 모델 정보 시도
      try{
        if(navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues){
          const high=await navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","model"]);
          if(high.model)model=high.model;
          if(high.platform&&/Android/i.test(high.platform))brand="Samsung";
        }
      }catch(e){}

      if(isAndroid){
        brand=brand||"Samsung";
        if(!model){
          const m=ua.match(/;\s?([A-Za-z0-9\-_ ]+)\sBuild\//);
          if(m)model=m[1].trim();
        }
        for(const prefix in samsungModels){
          if(model.startsWith(prefix)){model=samsungModels[prefix];break;}
        }
        const ver=ua.match(/Android\s([\d\.]+)/);
        if(ver)os=`Android ${ver[1]}`;
      }else if(isIOS){
        brand="Apple";
        const m=ua.match(/OS\s([\d_]+)/);
        if(m)os=`iOS ${m[1].replace(/_/g,".")}`;
        model="iPhone";
        badge.textContent="자동(제한됨)";
      }

      // identifier 우선 적용
      const id=getParam("identifier");
      if(id&&iPhoneMap[id]){
        brand="Apple";
        model=iPhoneMap[id];
        os="iOS";
        badge.textContent="확정(단축어)";
      }

      brandEl.textContent=brand||"-";
      modelEl.textContent=model||"-";
      osEl.textContent=os||"-";
      browserEl.textContent=browser;
      headlineEl.textContent=[brand,model].filter(Boolean).join(" ");
    }

    document.getElementById("detectBtn").addEventListener("click",detect);
    detect();
  </script>
</body>
</html>
